# 共识

区块链节点使用共识引擎来在区块链的状态上达成一致。本文介绍了区块链系统中共识的基本原理，共识如何与 Substrate 框架中的运行时交互，以及该框架可用的共识引擎。

## 状态机与冲突

区块链运行时是一个[状态机](https://en.wikipedia.org/wiki/Finite-state_machine)。它有一些内部状态，以及允许它从当前状态转换到到未来状态的状态转换函数。在大多数运行时中，有些状态有多种有效的转换到多个未来状态，但必须选择一种转换。

区块链必须达成一致在：

* 某种初始状态，称为 "创世 (genesis)"。
* 一系列的状态转换，每个被称为 "块"，和
* 一个最终的（当前）状态。

为了就转换后的结果状态达成一致，区块链的[状态转换函数](https://docs.substrate.io/v3/getting-started/glossary/#state-transition-function-stf)中的所有操作都必须是确定性的。

## 排除冲突

在中心化系统中，中央机构通过按照看到的顺序记录状态转换，在相互冲突的备选方案中进行选择，并在出现冲突时选择竞争方案中的第一个。在去中心化系统中，节点会以不同的顺序看到交易，因此它们必须使用一种更复杂的方法来排除冲突交易。更进一步的复杂性，区块链网络要努力做到容错，这意味着即使一些参与者不遵守规则，它们也应该继续提供一致的数据。
